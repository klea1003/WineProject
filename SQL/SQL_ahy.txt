
/*****장바구니 테이블*****/
CREATE TABLE TBL_CART_TEST(
	CART_NUM NUMBER PRIMARY KEY,
	USER_NUM NUMBER NOT NULL,
	WINE_NUM NUMBER NOT NULL,
	WINE_QTY NUMBER DEFAULT 0
);

/*시퀀스 생성*/
CREATE SEQUENCE SEQ_CART_TEST
START WITH 1
INCREMENT BY 1;
COMMIT;

/*유저테이블의 유저넘버 참조*/
ALTER TABLE TBL_CART_TEST
ADD CONSTRAINT CART_USER_NUM_FK FOREIGN KEY(USER_NUM)
REFERENCES TBL_USER_TEST(USER_NUM);

/*와인테이블의 와인넘버 참조*/
ALTER TABLE TBL_CART_TEST
ADD CONSTRAINT TBL_CART_TEST_WINE_NUM_FK FOREIGN KEY(WINE_NUM)
REFERENCES TBL_WINE_TEST(WINE_NUM);

/*셀러 테이블의 셀러넘버 참조*/
ALTER TABLE TBL_CART_TEST
ADD CONSTRAINT CART_SELLER_NUM_FK FOREIGN KEY(SELLER_NUM)
REFERENCES TBL_SELLER_TEST(SELLER_NUM);


COMMIT;

/*****주문(예약)하기 테이블*****/
CREATE TABLE TBL_ORDER_TEST(
	ORDER_NUM VARCHAR2(50) NOT NULL PRIMARY KEY,
	ORDER_NAME VARCHAR2(50) NOT NULL,
	USER_NUM NUMBER NOT NULL,
	PICKUP_NAME VARCHAR2(50) NOT NULL,
	PICKUP_PHONENUM VARCHAR2(30) NOT NULL,
	PICKUP_DATE VARCHAR2(50) NOT NULL,
	ORDER_DATE DATE DEFAULT SYSDATE,
	SELLER_NUM NUMBER NOT NULL,
	ORDER_COMMENT VARCHAR2(200),
	PAYMENT_NUM NUMBER NOT NULL	
);

CREATE SEQUENCE SEQ_ORDER_TEST
START WITH 1
INCREMENT BY 1;

COMMIT;

/*유저 테이블의 유저넘버 참조함*/
ALTER TABLE TBL_ORDER_TEST
ADD CONSTRAINT TBL_ORDER_TEST_USER_NUM FOREIGN KEY(USER_NUM)
REFERENCES TBL_USER_TEST(USER_NUM);


/****오더 아이템 테이블****/
CREATE TABLE TBL_ORDER_ITEM(
	ORDER_ITEM_NUM NUMBER NOT NULL PRIMARY KEY,
	ORDER_NUM VARCHAR2(50) NOT NULL,
	
	WINE_NUM NUMBER NOT NULL,
	WINE_QTY NUMBER DEFAULT 0
);

/*주문 상세번호 시퀀스*/
CREATE SEQUENCE SEQ_TBL_ORDER_ITEM;

/*주문 상세 테이블과 주문 테이블 참조*/
ALTER TABLE TBL_ORDER_DETAIL
ADD CONSTRAINT TBL_ORDER_DETAIL_ORDER_NUM FOREIGN KEY(ORDER_NUM)
REFERENCES TBL_ORDER_TEST(ORDER_NUM);

COMMIT;

CREATE TABLE TBL_ORDER_PAYMENT (
    PAYMENT_NUM NUMBER(20) NOT NULL,
    PAYMENT_TITLE VARCHAR2(100)
);

INSERT INTO TBL_ORDER_PAYMENT VALUES (1,'신용카드');
INSERT INTO TBL_ORDER_PAYMENT VALUES (2,'현금');
COMMIT;